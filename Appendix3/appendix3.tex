\chapter{Code Examples}

\begin{figure}[h]
\begin{lstlisting}[frame=tb]
type Node interface {
	Eval(*variables.Scope, *IOContainer) ExitStatus
}

type NodeIf struct {
	Condition Node
	Else      *NodeIf
	Body      Node
}

func (n NodeIf) Eval(scp *variables.Scope, ioc *IOContainer) ExitStatus {
	runBody := n.Condition.Eval(scp, ioc)
	if runBody == ExitSuccess {
		return n.Body.Eval(scp, ioc)
	}
	if n.Else != nil {
		return n.Else.Eval(scp, ioc)
	}
	return ExitSuccess
}     
\end{lstlisting}
\caption[The Node Interface]{The Node interface used in the AST. Also shows the NodeIf as an example of implementation. Interfaces are implicitly satisfied if the type has the required methods. \label{lst:node-interface}}
\end{figure}

\begin{figure}[h]
\begin{lstlisting}[frame=tb]
type NodeNoop struct{}

func (NodeNoop) Eval(*variables.Scope, *IOContainer) ExitStatus {
	return ExitSuccess 
}

type NodeEOF struct {
	NodeNoop
}
\end{lstlisting}
\caption[The EOF and No Op node]{The NodeEOF uses struct embedding to receive the methods of the NodeNoop.\label{lst:node-noop}}
\end{figure}


\begin{figure}[h]
\begin{lstlisting}[frame=tb]
func LeftShift(a, b int64) int64 {
	c := int64(math.Pow(2, float64(b)))
	if c == 0 {
		return a
	} else if c < 0 {
		panic("Negative Left Shift")
	}
	return a * c
}
func RightShift(a, b int64) int64 {
	c := int64(math.Pow(2, float64(b)))
	if c == 0 {
		return 0
	} else if c < 0 {
		panic("Negative Right Shift")
	}
	return a / c
}
\end{lstlisting}
\caption[Shift helper functions]{Go's compile time checks prevent using an int64 as an argument to a shift.\label{lst:arith-shift}}
\end{figure}

\begin{figure}[h]
\begin{lstlisting}[frame=tb]
switch currentCharacter:
...
case '<':
		switch l.next() {
		case '<':
			t = ArithLeftShift
			checkAssignmentOp = true
		case '=':
			t = ArithLessEqual
		default:
			t = ArithLessThan
			l.backup()
		}
...
if checkAssignmentOp {
	if l.hasNext('=') {
			t += ArithAssignDiff
		}
}
\end{lstlisting}
\caption[Shift helper functions]{Go's compile time checks prevent using an int64 as an argument to a shift.\label{lst:arith-shift}}
\end{figure}

